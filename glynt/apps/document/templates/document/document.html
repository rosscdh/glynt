{% extends 'document/base.html' %}
{% load i18n markup %}
{% load sign_tags %}
{% load glynt_helpers %}
{% load url from future %}


{% block owner_info %}
<div class="">
  <h2 id="document-title" class="editable">{{ userdoc.name }}</h2>
  <!-- <a href="{% url 'document:my_review' slug=userdoc.slug %}" rel="tooltip" title="">{% trans 'Review Document' %}</a> -->
  <form id="userdoc-name-form" class="hidden">
      {{ userdoc_form }}
  </form>
</div>
{% endblock %}

{% block form %}
    <div id="docu-form-head" class="row">
        <div id="messages" data-bind="html: App.message"></div>
    </div>
    {% for form in form_set %}
    <form id="glynt-doc-{{ forloop.counter }}"  class="form-horizontal bind-document">{% csrf_token %}
    <div id="form-group-{{ forloop.counter }}" class="form-group hidden">
        <h3><span class="step-title"></span></h3>
        {% for field in form %}
          {% if field.is_hidden %}
            {{ field }}
          {% else %}
          <div class="control-group">
            {{ field.label_tag }}
            <div class="controls">
            {{ field }}
            {% if field.help_text %}
            <span class="helptext">{{ field.help_text }}</span>
            {% endif %}
            </div>
          </div>
          {% endif %}
        {% endfor %} 
    </div>
    </form>
    {% endfor %}
  <div class="row">
      <div id="last-step" class="span12 hide form-horizontal" data-bind="visible: App.formControls.isLastStep()">
        <h3><span class="step-title">Document Complete</span></h3>
      <br />
      <div id="form-group-{{ final_step_index }}" class="control-group">
            <label>Download a PDF of the document</label>
        <div id="formCompleteOptions" class="controls">
              <button id="btn-post-pdf" class="btn btn-green btn-success" type="button">{% trans 'Download PDF' %}</button>
            </div>
        </div>
      <div id="form-group-{{ final_step_index }}" class="control-group">
            <div id="formCompleteOptions" class="controls">
              <div id="invite-to-sign" data-can_add_invite="{% if can_add_invite %}{{ can_add_invite }}{% endif %}" class="row" data-bind="visible: App.formControls.isLastStep()">&nbsp;</div>
            </div>
        </div>
      </div>
  </div>
    <div id="progress-buttons" class="hide controls">
        <div class="previous-button">
        <span data-bind="visible: App.formControls.showPrev()"><button id="btn-prev" class="btn btn-grey btn-large btn-prev" type="button" data-bind="click: App.formControls.prev">{% trans 'Previous' %}</button></span>
    </div>
    <div class="next-button">
      <span data-bind="visible: App.formControls.showNext()">
        <button id="btn-next" class="btn btn-success btn-large btn-next" type="button" data-bind="click: App.formControls.next">{% trans 'Next Step' %}</button>
      </span>
    </div>
  </div>
{% endblock %}

{% block document_head %}
<div class="row">
  <div id="step-set" data-bind="html: App.stepListDisplay()"></div>
</div>
{% endblock %}

{% block document %}
<div class="doc-body">
<span id="document-md" data-bind="html: App.documentModel.renderedHTML()">{% show_loading modal='False' %}</span>
</div>
{% endblock %}

{% block css %}
<style>
ul.form-fields{
  list-style-type: none;
}
.hidden {
  display:none;
}
form div.form-group ul{
  list-style-type: none;
  list-style: none;
}
.doc-var{
  background-color:#ccc;
}
span.helptext {
display:none;
}
.editable{
  cursor: pointer;
  background-color:transparent;
}
.editable:hover{
    background-color:#f5f5f5;
}
ul#step-list li a{
  font-size:12px;
}
.invitee-vehicle {
  padding:10px;
}
</style>
{% endblock %}

{% block js %}
{% include 'document/inline/document.js' %}
{% invite_to_sign userdoc '#invite-to-sign' %}
{% endblock %}