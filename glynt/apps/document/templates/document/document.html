{% extends 'document/base.html' %}
{% load i18n markup %}
{% load sign_tags %}
{% load url from future %}


{% block owner_info %}
<div class="span12">
  <h2 id="document-title" class="editable">{{ userdoc.name }}</h2>
  <form id="userdoc-name-form" class="hidden">
      {{ userdoc_form }}
  </form>
</div>
{% endblock %}

{% block form %}
    <div id="docu-form-head" class="row">
        <div id="messages" data-bind="html: App.message"></div>
    </div>
    <div class="row">
        <div class="controls pull-right">
            <span data-bind="visible: App.formControls.showPrev()"><button id="btn-prev" class="btn btn-primary btn-small btn-prev" type="button" data-bind="click: App.formControls.prev">{% trans 'Previous' %}</button></span>
            <span data-bind="visible: App.formControls.showNext()"><button id="btn-next" class="btn btn-success btn-small btn-next" type="button" data-bind="click: App.formControls.next">{% trans 'Save Step' %}</button></span>
        </div>
    </div>
    {% for form in form_set %}
    <form id="glynt-doc-{{ forloop.counter }}"  class="form-horizontal bind-document">{% csrf_token %}
    <div id="form-group-{{ forloop.counter }}" class="form-group hidden">
        <h3><span class="step-title"></span></h3>
        <ul>
        {{ form.as_ul }}
        </ul>
    </div>
    </form>
    {% endfor %}
    <div class="row">
      <div id="form-group-{{ final_step_index }}" class="form-group" data-bind="visible: App.formControls.isLastStep()">
          <div id="formCompleteOptions" class="span3 border">
              <button id="btn-post-pdf" class="btn btn-success" type="button">{% trans 'Download PDF' %}</button>
          </div>
      </div>
      <div data-bind="visible: App.formControls.isLastStep()">
        <div id="invite-to-sign">&nbsp;</div>
        <div id="signatory-detail">&nbsp;</div>
      </div>
    </div>
    <div class="row">
        <div class="controls pull-right">
            <span data-bind="visible: App.formControls.showPrev()"><button id="btn-prev" class="btn btn-primary btn-small btn-prev" type="button" data-bind="click: App.formControls.prev">{% trans 'Previous' %}</button></span>
            <span data-bind="visible: App.formControls.showNext()"><button id="btn-next" class="btn btn-success btn-small btn-next" type="button" data-bind="click: App.formControls.next">{% trans 'Save Step' %}</button></span>
        </div>
    </div>
{% endblock %}

{% block document_head %}
<div class="row">
  <div id="step-set" data-bind="html: App.stepListDisplay()"></div>
</div>
{% endblock %}

{% block document %}
<span id="document-md" data-bind="html: App.documentModel.renderedHTML()"></span>
{% endblock %}

{% block css %}
<style>
ul.form-fields{
  list-style-type: none;
}
.hidden {
    display:none;
}
form div.form-group ul{
    list-style-type: none;
    list-style: none;
}
.doc-var{
    background-color:#ccc;
}
span.helptext {
display:none;
}
.editable{
    cursor: pointer;
    background-color:transparent;
}
.editable:hover{
    background-color:#f5f5f5;
}
ul#step-list{
  list-style-type: none;
  list-style: none;
}
ul#step-list li{
  float:left;
  cursor:pointer;
  width:16px;
  height:20px;
  margin:0px 2px;
  background-color:#ccc;
  border:solid #aaa 1px;
}
ul#step-list li.current_step{
  background-color:#0c0;
  border:solid #aaa 1px;
}
ul#step-list li.last_step{
  background-color:#00c;
  border:solid #aaa 1px;
}
</style>
{% endblock %}

{% block js %}
{% include 'document/inline/document.js' %}
{% invite_to_sign userdoc '#invite-to-sign' %}
{% endblock %}