{% extends 'base.html' %}{% load account_tags lawyer_profile_tags jsonify thumbnail cache %}

{% block page_title %}{{ object.user.get_full_name|default:object.user.username }}{% endblock %}
{% block bodyclass %}lawyer-profile{% endblock %}

{% block css %}
<link href="{{ STATIC_URL }}css/theme/lawyer-profile.css" rel="stylesheet" charset="utf-8" />
{% endblock %}
{% block js %}
<script type="text/javascript" src="{{ STATIC_URL }}js/Chart.min.js"></script>
{% endblock %}

{% block prebody %}

<div id="hero">
	<div class="container">
		<!-- starts carousel -->
		<div class="row animated fadeInRight profile-details">
			<div class="span5">
				<div class="avatar">
					<img src="{{ object.profile_photo }}" alt="{{ object.user.get_full_name|default:object.user.username }}" />
				</div>
			</div>
			<div class="span7">
				<h1>{{ object.user.get_full_name|default:object.user.username }}</h1>
				<h3>{{ object.summary }}</h3>
			</div>
		</div>
	</div>
	<div id="buttons">
		<div class="container">
			<div class="row12">
				{% if user.username == object.user.username %}
					<a href="{% url 'lawyer:setup_profile' %}" class="btn">Edit profile</a>  
					<a href="{% url 'lawyer:invite' %}" class="btn btn-primary">Invite Lawyers</a> 
					{% if object.summary %} 
					    <script>
						  $(document).ready(function () {
					     	  Intercom('update', {"Lawyer Profile": "Complete", "Firm": "{{ firm }}"});
					   	 });
						</script>
					{% endif %}
					<a href="#comingSoonModal" class="btn right" title="Message" data-toggle="modal"><i class="icon-envelope"></i> Message</a>
					<a href="#comingSoonModal" class="btn right" title="Endorse" data-toggle="modal"><i class="icon-star"></i> Endorse</a>
					<a href="#comingSoonModal" class="btn right" title="Engage"  data-toggle="modal"><i class="icon-play"></i> Engage</a>
				{% endif %}
			</div>
		</div>
	</div>
</div>
<div class="container profile">
	<div class="row">
		<div class="span8">	
			<h2>About</h2>
			<div>
				<p>{{ object.bio|default:"<div class=\"no-data\">No biography yet.</div>"|linebreaksbr }}</p>
			</div>
			<br />
		</div>	
		<div class="span4 pull-right">
			<div class="firm">
				{% if firm.photo %}
					<img src="{{ MEDIA_URL }}{{ firm.photo|default:'firm/blank.gif' }}" alt="{{ firm.name }}" class="firm-logo" />				
				{% else %} 
					{% if firm %}
						<h2>{{ firm }}</h2>
					{% else %}
						<br />
					{% endif %}
				{% endif %} 
			</div>
			<div class="map">
				{% if object.data.practice_location_1 and not object.data.practice_location_2 %}
					<img src="http://maps.googleapis.com/maps/api/staticmap?size=300x145&markers=color:blue%7Clabel:S%7C{{ object.data.practice_location_1 }}&sensor=false&maptype=roadmap">
				{% endif %}
				{% if object.data.practice_location_1 and object.data.practice_location_2 %}
					<img src="http://maps.googleapis.com/maps/api/staticmap?size=150x145&markers=color:blue%7Clabel:S%7C{{ object.data.practice_location_1 }}&sensor=false"><img src="http://maps.googleapis.com/maps/api/staticmap?size=149x145&markers=color:blue%7Clabel:S%7C{{ object.data.practice_location_2 }}&sensor=false">
				{% endif %}
				<ul>
					{% for practice_location in object.practice_locations  %}
						<li class="marker">{{ practice_location }}</li>
					{% endfor %}
					{% if object.data.years_practiced > 0 %}	
						<li class="tick">{{ object.data.years_practiced }} Years Practicing</li>
					{% endif %}
					<li class="star">No endorsements yet</li>
					<!-- <li class="friends"><img src="/static/img/app/small-avatar.jpg" alt="Avatar" /> Benjamin Ling is a mutual contact</li> -->
				</ul>				
			</div>
			<div class="other-profiles">
				<h5>Other Profiles</h5>
				{% social_profiles object.user %}
 			</div>
			<!-- <div class="bar-license">
				<h5>Licensed In</h5>
				{% for o in object.data.bar_membership  %}
					{{ o }}
				{% endfor %}
			</div> -->
		</div>	
		<div class="span8">
			<h2>Transaction Snapshot</h2>
			<div class="deal-charts row">
				<div class="span4">
					<h5>Transactions by year</h5>
					<br />
					<canvas id="dealChart0" width="300" height="200"></canvas>
				</div>
				<div class="span4" style="position:relative;">			
					<h5>Transactions by type</h5>
					<br />		
					<canvas id="dealChart1" width="220" height="200"></canvas>
					<div style="position:absolute;top:125px;right:-0px">
						<span class="label label-info" style="color:#F38630;background-color:white;">Series A</span>
						<br /> 
						<span class="label label-info" style="color:#6bdb7e;background-color:white;">Seed</span> 
						<br />
						<span class="label label-info" style="color:#69D2E7;background-color:white;">Incorporation</span> 
						<br />
						<span class="label label-info" style="color:#f88172;background-color:white;">IP</span>
						<br />
						<span class="label label-info" style="background-color:white;color:#6ndn7e">Other</span>
					</div>
				</div>
			</div>
		</div>
		<div class="span8">
			<div class="startups">
				<h2>Startups Advised</h2>
				{% for o in object.data.startups_advised %}
					<span><img src="http://{{ o }}/favicon.ico" class="fav"> <a href="http://{{ o }}" target="_BLANK" class="domain">{{ o }}</a></span>
				{% endfor %}
			</div>
			<br />
			<br />
			<br />
		</div>
<!-- 		<div class="span8">
			<div class="startups">
				<h2>Other Webistes</h2>
				{% for o in object.data.websites %}
					<span><img src="http://{{ o }}/favicon.ico" class="fav"> <a href="http://{{ o }}" target="_BLANK" class="domain">{{ o }}</a></span>
				{% endfor %}
			</div>
		</div> -->
	</div>



	<div>
	    <div class=" buttons">
			<!-- Modal -->
			<div id="comingSoonModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			  <div class="modal-header">
			    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
			    <h3 id="myModalLabel">Coming Soon</h3>
			  </div>
			  <div class="modal-body">
			    <p>Whilst profiles are in preview mode, this feature is disabled. We will shortly be enabling this for some users as part of our rollout.</p>
			  </div>
			  <div class="modal-footer">
			    <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
			    <!-- <button class="btn btn-primary">Save changes</button> -->
			  </div>
			</div>
		
		</div>
	</div>

	<div class="divide">
		<div class="endorsements">
			<h2>More profile data coming soon.</h2>
		</div>
	</div>
</div>
{% endblock %}

{% block body %}

<script>

$(document).ready(function () {
$('img').error(function() {
	$(this).attr("src", '/static/img/app/hyperlink_blue.png');
});


	//Get context with jQuery - using jQuery's .get() method.
	var ctx0 = $("#dealChart0").get(0).getContext("2d");
	var ctx1 = $("#dealChart1").get(0).getContext("2d");

	linedefaults = { scaleShowLabels : true }

	if('{{ object.data.volume_by_year.2011 }}' > 0) {
		new Chart(ctx0).Line({
			labels : ["2010","2011","2012"],
			datasets : [{
					fillColor : "rgba(151,187,205,0.5)",
					strokeColor : "rgba(151,187,205,1)",
					pointColor : "rgba(151,187,205,1)",
					pointStrokeColor : "#fff",
					data : [{{ object.data.volume_by_year.2011 }},{{ object.data.volume_by_year.2012 }},{{ object.data.volume_by_year.2013 }}]
				}]
			}
			,linedefaults);
	}
	if('{{ object.data.volume_series_a }}' > 0) {
		new Chart(ctx1).Doughnut([
			{
				value: {{ object.data.volume_series_a|jsonify }},
				color:"#F38630"
			},
			{
				value: {{ object.data.volume_seed_financing|jsonify }},
				color : "#6bdb7e"
			},
			{
				value : {{ object.data.volume_incorp_setup|jsonify }},
				color : "#69D2E7",
			},
			{
				value: {{ object.data.volume_other|jsonify }},
				color : "#3a87ad"
			},
			{
				value : {{ object.data.volume_ip|jsonify }},
				color : "#f88172"
			}			
		]);
	 }

});
</script>
{% endblock %}